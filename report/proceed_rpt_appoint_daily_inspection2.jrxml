<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.8.0.final using JasperReports Library version 6.8.0-2ed8dfabb690ff337a5797129f2cd92902b0c87b  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="proceed_rpt_appoint_daily_inspection2" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="f0fbd027-aa76-49a7-a9ea-e6fd8fc809b0">
	<property name="ireport.jasperserver.url" value="http://119.59.126.229/jasperserver/"/>
	<property name="ireport.jasperserver.user" value="jasperadmin"/>
	<property name="ireport.jasperserver.reportUnit" value="/reports/proceed_rpt_appoint_daily_inspection2"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="jvnc-229"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<parameter name="SELECT_DATE" class="java.lang.String">
		<defaultValueExpression><![CDATA["03/03/2021"]]></defaultValueExpression>
	</parameter>
	<parameter name="ROOM_COD" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT
    PCPAC.START_DATE         AS  APPOINT_DATE,   
    CASE WHEN PCC.BLACK_IDNUM IS NOT NULL 
		     THEN PCLTS.TITLE_CASE_NAME||PCC.BLACK_IDNUM||'/'||PCC.BLACK_YEAR 
		     ELSE '-' END CASE_BLACE_NO, 
	CASE WHEN PCJM.RED_IDNUM IS NOT NULL
		     THEN PCLTS_R.TITLE_CASE_NAME||PCJM.RED_IDNUM||'/'||PCJM.RED_YEAR 
		     ELSE '-' END CASE_READ_NO,
    PCPAC.CHOICE_TIME                   AS  APPOINT_TIME,
	PCC.PROS_DESC ,
    PCC.ACCU_DESC ,
    PCC.ALLE_DESC ,
    PCLAR.APPOINT_REASON_NAME           AS  APPOINT_REASON, 
    pllr.LEVEL_ROOM_DESC ,
    IDIOM_OWNER.JUDGE_NAME				AS IDIOM_OWNER,
    IDIOM_ORGANIZATION1.JUDGE_NAME		AS IDIOM_ORGANIZATION1,
    IDIOM_ORGANIZATION2.JUDGE_NAME		AS IDIOM_ORGANIZATION2,
    ASSOCIATE_JUDGE.JUDGE_NAME			AS ASSOCIATE_JUDGE,
    (COALESCE(PCPA.INVESTIGATE_ACCUSER_CONFESSION ,0)+ COALESCE(PCPA.INVESTIGATE_ACCUSER,0) + COALESCE(PCPA.INVESTIGATE_DEFENDANT,0) + COALESCE(PCPA.INVESTIGATE_OTHER,0)) AS INVESTIGATE,
    (COALESCE(PCPA.INVESTIGATE_ACCUSER_CONFESSION_DATE,0)+ COALESCE(PCPA.INVESTIGATE_ACCUSER_DATE,0) + COALESCE(PCPA.INVESTIGATE_DEFENDANT_DATE,0) + COALESCE(PCPA.INVESTIGATE_OTHER_DATE,0)) AS INVESTIGATE_DATE
    ,PCPACNT.APPOINT_NEXT_DATE
    ,PCPACNT.APPOINT_NEXT_REASON
    --
	FROM PC_PROCEED_APPOINT PCPA
    JOIN PC_PROCEED_APPOINT_CONTINUE PCPAC ON PCPA.APPOINT_ID = PCPAC.APPOINT_ID AND PCPAC.REMOVED_BY = 0 
    LEFT JOIN PC_CASE PCC ON PCPA.CASE_ID = PCC.CASE_ID    
    LEFT JOIN PC_JUDGEMENT PCJM ON PCC.CASE_ID = PCJM.CASE_ID
    LEFT JOIN PC_LOOKUP_TITLE_CASE PCLTS ON PCC.CASE_CATE_ID = PCLTS.CASE_CATE_ID
    LEFT JOIN PC_LOOKUP_TITLE_CASE PCLTS_R ON PCLTS_R.TITLE_CASE_ID = PCJM.RED_TITLE_ID AND PCLTS_R.REMOVED_BY = 0    
    LEFT JOIN PC_LOOKUP_APPOINT_REASON PCLAR ON PCPAC.REASON_APPOINT_ID = PCLAR.APPOINT_REASON_ID
    LEFT JOIN 
    (
	    SELECT pcj.CASE_ID ,pljt.JUDGE_TYPE_NAME,plj.JUDGE_NAME ,pljt.JUDGE_TYPE_CODE
		FROM PC_CASE_JUDGE pcj  
		LEFT JOIN PC_LOOKUP_JUDGE_TYPE pljt ON pljt.JUDGE_TYPE_ID = pcj.JUDGE_TYPE_ID
		LEFT JOIN PC_LOOKUP_JUDGE plj ON plj.JUDGE_ID = pcj.JUDGE_ID 
		WHERE pcj.REMOVED_BY = 0
		GROUP BY pcj.CASE_ID ,pljt.JUDGE_TYPE_NAME,plj.JUDGE_NAME ,pljt.JUDGE_TYPE_CODE
	) IDIOM_OWNER ON IDIOM_OWNER.CASE_ID = PCC.CASE_ID AND IDIOM_OWNER.JUDGE_TYPE_CODE ='01' -- เจ้าของสำนวน
	LEFT JOIN (
	    SELECT pcj.CASE_ID ,pljt.JUDGE_TYPE_NAME,plj.JUDGE_NAME ,pljt.JUDGE_TYPE_CODE
		FROM PC_CASE_JUDGE pcj  
		LEFT JOIN PC_LOOKUP_JUDGE_TYPE pljt ON pljt.JUDGE_TYPE_ID = pcj.JUDGE_TYPE_ID
		LEFT JOIN PC_LOOKUP_JUDGE plj ON plj.JUDGE_ID = pcj.JUDGE_ID 
		WHERE pcj.REMOVED_BY = 0
		GROUP BY pcj.CASE_ID ,pljt.JUDGE_TYPE_NAME,plj.JUDGE_NAME ,pljt.JUDGE_TYPE_CODE
	) IDIOM_ORGANIZATION1 ON IDIOM_ORGANIZATION1.CASE_ID = PCC.CASE_ID AND IDIOM_ORGANIZATION1.JUDGE_TYPE_CODE ='05' --องค์คณะผู้ตัดสิน1
	LEFT JOIN (
	    SELECT pcj.CASE_ID ,pljt.JUDGE_TYPE_NAME,plj.JUDGE_NAME ,pljt.JUDGE_TYPE_CODE
		FROM PC_CASE_JUDGE pcj  
		LEFT JOIN PC_LOOKUP_JUDGE_TYPE pljt ON pljt.JUDGE_TYPE_ID = pcj.JUDGE_TYPE_ID
		LEFT JOIN PC_LOOKUP_JUDGE plj ON plj.JUDGE_ID = pcj.JUDGE_ID 
		WHERE pcj.REMOVED_BY = 0
		GROUP BY pcj.CASE_ID ,pljt.JUDGE_TYPE_NAME,plj.JUDGE_NAME ,pljt.JUDGE_TYPE_CODE
	)  IDIOM_ORGANIZATION2 ON IDIOM_ORGANIZATION2.CASE_ID = PCC.CASE_ID AND IDIOM_ORGANIZATION2.JUDGE_TYPE_CODE ='06' --องค์คณะผู้ตัดสิน1
    LEFT JOIN (
	    SELECT pcj.CASE_ID ,pljt.JUDGE_TYPE_NAME,plj.JUDGE_NAME ,pljt.JUDGE_TYPE_CODE
		FROM PC_CASE_JUDGE pcj  
		LEFT JOIN PC_LOOKUP_JUDGE_TYPE pljt ON pljt.JUDGE_TYPE_ID = pcj.JUDGE_TYPE_ID
		LEFT JOIN PC_LOOKUP_JUDGE plj ON plj.JUDGE_ID = pcj.JUDGE_ID 
		WHERE pcj.REMOVED_BY = 0
		GROUP BY pcj.CASE_ID ,pljt.JUDGE_TYPE_NAME,plj.JUDGE_NAME ,pljt.JUDGE_TYPE_CODE
	)  ASSOCIATE_JUDGE ON ASSOCIATE_JUDGE.CASE_ID = PCC.CASE_ID AND ASSOCIATE_JUDGE.JUDGE_TYPE_CODE ='08' --ผู้พิพากษาสมทบ
    --
	LEFT JOIN PC_LOOKUP_LEVEL_ROOM pllr ON pllr.LEVEL_ROOM_ID = PCPAC.LEVEL_ROOM_CODE AND pllr.REMOVED_BY = 0
	--
	LEFT JOIN (
	  SELECT PCPACN.APPOINT_ID ,PCPACN.START_DATE AS  APPOINT_NEXT_DATE, PCLARN.APPOINT_REASON_NAME AS  APPOINT_NEXT_REASON 
	  FROM PC_PROCEED_APPOINT_CONTINUE PCPACN 	
	  LEFT JOIN PC_LOOKUP_APPOINT_REASON PCLARN ON PCPACN.REASON_APPOINT_ID = PCLARN.APPOINT_REASON_ID
	  WHERE PCPACN.START_DATE > TO_DATE('3/03/2021'||'T23:59:59', 'DD-MM-YYYY"T"HH24:MI:SS') AND PCPACN.REMOVED_BY = 0 
	  FETCH FIRST 1 ROWS ONLY	  
	  ) PCPACNT ON PCPACNT.APPOINT_ID = PCPA.APPOINT_ID 
	  --
	WHERE PCPA.REMOVED_BY = 0 AND PCC.CASE_ID IS NOT NULL 
	AND PCPAC.START_DATE = TO_DATE($P{SELECT_DATE} ||'T00:00:00', 'DD-MM-YYYY"T"HH24:MI:SS')
	AND ($P{ROOM_COD} IS NULL OR pllr.LEVEL_ROOM_CODE = $P{ROOM_COD})]]>
	</queryString>
	<field name="APPOINT_DATE" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="APPOINT_DATE"/>
	</field>
	<field name="CASE_BLACE_NO" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="CASE_BLACE_NO"/>
	</field>
	<field name="CASE_READ_NO" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="CASE_READ_NO"/>
	</field>
	<field name="APPOINT_TIME" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="APPOINT_TIME"/>
	</field>
	<field name="PROS_DESC" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="PROS_DESC"/>
	</field>
	<field name="ACCU_DESC" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="ACCU_DESC"/>
	</field>
	<field name="ALLE_DESC" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="ALLE_DESC"/>
	</field>
	<field name="APPOINT_REASON" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="APPOINT_REASON"/>
	</field>
	<field name="LEVEL_ROOM_DESC" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="LEVEL_ROOM_DESC"/>
	</field>
	<field name="IDIOM_OWNER" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="IDIOM_OWNER"/>
	</field>
	<field name="IDIOM_ORGANIZATION1" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="IDIOM_ORGANIZATION1"/>
	</field>
	<field name="IDIOM_ORGANIZATION2" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="IDIOM_ORGANIZATION2"/>
	</field>
	<field name="ASSOCIATE_JUDGE" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="ASSOCIATE_JUDGE"/>
	</field>
	<field name="INVESTIGATE" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="INVESTIGATE"/>
	</field>
	<field name="INVESTIGATE_DATE" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="INVESTIGATE_DATE"/>
	</field>
	<field name="APPOINT_NEXT_DATE" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="APPOINT_NEXT_DATE"/>
	</field>
	<field name="APPOINT_NEXT_REASON" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="APPOINT_NEXT_REASON"/>
	</field>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="79" splitType="Stretch">
			<staticText>
				<reportElement x="274" y="35" width="100" height="30" uuid="5056cfda-8275-4989-bc3c-5d14f4b89255"/>
				<text><![CDATA[Static Text]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band height="35" splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="61" splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="125" splitType="Stretch">
			<textField isStretchWithOverflow="true">
				<reportElement x="131" y="21" width="100" height="30" uuid="4df446d4-f032-422c-ab5a-26d787ca9a01"/>
				<textFieldExpression><![CDATA[$F{ALLE_DESC}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band height="45" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="54" splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="42" splitType="Stretch"/>
	</summary>
</jasperReport>
